<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolishIQ - AI Text Enhancer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for textareas */
        textarea::-webkit-scrollbar {
            width: 10px;
        }
        textarea::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5); /* slate-800 with opacity */
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb {
            background: rgba(219, 39, 119, 0.7); /* pink-600 with opacity */
            border-radius: 10px;
            border: 2px solid rgba(30, 41, 59, 0.5); 
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: rgba(219, 39, 119, 0.9); /* pink-500 with opacity */
        }

        /* Shine effect for buttons */
        @keyframes subtleShine {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .shine-button {
            background-size: 250% 250%;
        }
        .shine-button:hover:not(:disabled) {
            animation: subtleShine 3s ease-out infinite;
        }

        /* Skeleton loader animation */
        .skeleton-loader {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        /* Custom select arrow for the <select> element */
        .custom-select-arrow {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23f9a8d4'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' /%3E%3C/svg%3E"); /* pink-300 */
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-right: 3rem; /* Make space for arrow */
        }

        /* Styling for individual <option> elements within the select dropdown */
        select option {
            background-color: #0f172a; /* slate-900 */
            color: #cbd5e1;           /* slate-300 */
            padding: 12px 18px;
            font-size: 0.95rem;
            border-bottom: 1px solid #1e293b; /* slate-800 */
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        select option:last-child {
            border-bottom: none;
        }
        select option:hover,
        select option:focus {
            background-color: #581c87; /* purple-800 */
            color: #f5d0fe;           /* purple-200 */
            cursor: pointer;
        }

        /* Animated gradient border for main card */
        .aurora-border-container {
            position: relative; padding: 2px; border-radius: 1.15rem; 
            background: linear-gradient(120deg, #ec4899, #8b5cf6, #06b6d4, #ec4899);
            background-size: 300% 300%; animation: majesticAurora 10s linear infinite; z-index: 0;
        }
        @keyframes majesticAurora {
            0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; }
        }
        .aurora-border-container > div { border-radius: 1rem; }

        /* Toast animations */
        .toast-enter { opacity: 0; transform: translateY(20px) scale(0.95); }
        .toast-enter-active { opacity: 1; transform: translateY(0) scale(1); transition: opacity 300ms ease-out, transform 300ms ease-out; }
        .toast-exit { opacity: 1; transform: translateX(0); }
        .toast-exit-active { opacity: 0; transform: translateX(100%); transition: opacity 300ms ease-in, transform 300ms ease-in; }

        /* --- UPDATED FOCUS STYLES --- */
        #outputText:focus { /* Output textarea has specific no-focus-ring requirement */
            outline: none; box-shadow: none; border-color: #334155; /* slate-700 (its original border color) */
        }

        /* Professional focus for text inputs and selects */
        textarea#inputText:focus,
        select#enhanceMode:focus {
            outline: none;
            border-color: #38bdf8; /* sky-400 */
            box-shadow: 0 0 0 1px #38bdf8; /* sky-400, 1px ring */
        }

        /* Focus for primary action buttons */
        button#enhanceButton:focus {
            outline: none;
            border-color: #ec4899; /* pink-500, a main accent color */
            box-shadow: 0 0 0 2px rgba(236, 72, 153, 0.4); /* pink-500 with opacity (40%) for the ring */
        }

        /* Focus for utility buttons (remains as previously defined and suitable) */
        #copyButton:focus, #pasteButton:focus, #clearButton:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(219, 39, 119, 0.5); /* pink-500 with opacity (50%) */
        }
        /* --- END OF UPDATED FOCUS STYLES --- */

    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-950 to-indigo-950 text-slate-200 min-h-screen flex flex-col items-center justify-center p-4 selection:bg-pink-500 selection:text-white">

    <div class="aurora-border-container w-full max-w-3xl shadow-2xl shadow-purple-900/30">
        <div class="bg-slate-800/90 backdrop-blur-2xl p-6 md:p-10 w-full space-y-8 transform transition-all duration-500">
            
            <header class="text-center">
                <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-400 via-fuchsia-500 to-purple-500 mb-2 flex items-center justify-center">
                    <i class="fas fa-rocket mr-3 text-fuchsia-400 text-3xl md:text-4xl transform -rotate-12"></i>PolishIQ
                </h1>
                <p class="text-slate-400 text-sm md:text-base font-medium">
                    AI-Powered Text Refinement for Clarity, Impact, and Precision.
                </p>
            </header>

            <div id="error-message-container" class="hidden bg-red-700/30 border border-red-600/70 text-red-300 px-4 py-3 rounded-lg relative transition-all duration-300" role="alert">
                <strong class="font-bold"><i class="fas fa-exclamation-triangle mr-2"></i>Error:</strong>
                <span id="error-message" class="block sm:inline">Something went wrong.</span>
            </div>

            <main class="space-y-6">
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label for="inputText" class="text-sm font-medium text-slate-300">Your Text:</label>
                        <div>
                            <button id="pasteButton" title="Paste from Clipboard" class="px-3 py-1.5 text-xs text-slate-400 hover:text-pink-400 transition-colors duration-150 rounded-md hover:bg-slate-700/60 active:bg-slate-700/80">
                                <i class="fas fa-paste text-sm mr-1"></i>Paste
                            </button>
                            <button id="clearButton" title="Clear Input" class="ml-2 px-3 py-1.5 text-xs text-slate-400 hover:text-pink-400 transition-colors duration-150 rounded-md hover:bg-slate-700/60 active:bg-slate-700/80">
                                <i class="fas fa-times text-sm mr-1"></i>Clear
                            </button>
                        </div>
                    </div>
                    <div class="relative">
                        <textarea id="inputText" rows="6" class="w-full p-4 rounded-lg bg-slate-700 text-slate-100 border border-slate-600 transition-all duration-150 placeholder-slate-400 resize-y"></textarea>
                    </div>
                </div>

                <div class="text-center">
                    <div class="flex flex-col sm:flex-row items-center justify-center space-y-3 sm:space-y-0 sm:space-x-4">
                        <select id="enhanceMode" class="w-full sm:w-auto px-4 py-3 bg-slate-700 text-slate-100 border border-slate-600 rounded-lg appearance-none custom-select-arrow">
                            <option value="formal">Formalize</option>
                            <option value="simplify">Simplify</option>
                            <option value="creative">Make Creative</option>
                            <option value="concise">Make Concise</option>
                        </select>
                        <button id="enhanceButton" class="w-full sm:w-auto shine-button relative group px-8 py-3 bg-gradient-to-r from-pink-500 via-fuchsia-600 to-purple-600 hover:from-pink-600 hover:via-fuchsia-500 hover:to-purple-500 text-white font-semibold rounded-lg shadow-lg hover:shadow-fuchsia-500/40 transition-all duration-300 transform hover:scale-105 disabled:opacity-60 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none">
                            <span class="absolute left-0 inset-y-0 flex items-center pl-4">
                                <i id="buttonIcon" class="fas fa-wand-magic-sparkles text-lg"></i>
                            </span>
                            Enhance Text
                        </button>
                    </div>
                </div>
                
                <div>
                    <div class="flex justify-between items-center mb-2">
                         <label for="outputText" class="text-sm font-medium text-slate-300">Enhanced Text:</label>
                    </div>
                    <div class="relative">
                        <textarea id="outputText" rows="6" class="w-full p-4 rounded-lg bg-slate-700 text-slate-100 border border-slate-600 transition-all duration-150 placeholder-slate-400 resize-y caret-transparent" readonly></textarea>
                        <div id="outputSkeleton" class="absolute inset-0 p-4 space-y-3 bg-slate-700/80 rounded-lg hidden">
                            <div class="h-4 bg-slate-600/70 rounded w-full skeleton-loader"></div>
                            <div class="h-4 bg-slate-600/70 rounded w-5/6 skeleton-loader" style="animation-delay: 0.1s;"></div>
                            <div class="h-4 bg-slate-600/70 rounded w-3/4 skeleton-loader" style="animation-delay: 0.2s;"></div>
                            <div class="h-4 bg-slate-600/70 rounded w-4/6 skeleton-loader" style="animation-delay: 0.3s;"></div>
                        </div>

                        <button id="copyButton" title="Copy to Clipboard" class="absolute top-3 right-3 p-2 text-slate-400 hover:text-pink-400 transition-colors duration-150 rounded-md hover:bg-slate-600/50 active:bg-slate-600/70">
                            <i class="fas fa-copy text-lg"></i>
                        </button>
                    </div>
                </div>
            </main>
            
            <footer class="text-center mt-6 pt-6 border-t border-slate-700/50">
                <p class="text-xs text-slate-500">
                    Â© <span id="currentYear"></span> PolishIQ. Designed with <i class="fas fa-heart text-pink-500 transition-transform hover:scale-125 inline-block"></i> & AI.
                </p>
            </footer>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed bottom-5 right-5 space-y-3 z-[100]">
    </div>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const API_KEY = "AIzaSyDSF270Y1VJf1fe4G8ZAuw7bOITbAlal74"; 
        const MODEL_NAME = "gemini-2.0-flash"; 
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`;

        const inputTextElem = document.getElementById('inputText');
        const outputTextElem = document.getElementById('outputText');
        const enhanceButton = document.getElementById('enhanceButton');
        const buttonIcon = document.getElementById('buttonIcon');
        const copyButton = document.getElementById('copyButton');
        const clearButton = document.getElementById('clearButton');
        const pasteButton = document.getElementById('pasteButton');
        
        const errorMessageContainer = document.getElementById('error-message-container');
        const errorMessageElem = document.getElementById('error-message');
        
        const outputSkeleton = document.getElementById('outputSkeleton');

        inputTextElem.addEventListener('input', () => {
            if (!inputTextElem.value.trim()) {
                outputTextElem.value = '';
            }
        });

        inputTextElem.addEventListener('keypress', (event) => {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault(); 
                enhanceButton.click(); 
            }
        });

        enhanceButton.addEventListener('click', async () => {
            const textToEnhance = inputTextElem.value.trim();

            if (!textToEnhance) {
                showError("Input text cannot be empty.");
                showToast("Input text cannot be empty.", "error");
                return;
            }

            enhanceButton.disabled = true;
            buttonIcon.classList.remove('fa-wand-magic-sparkles');
            buttonIcon.classList.add('fa-spinner', 'fa-spin');
            errorMessageContainer.classList.add('hidden');
            outputTextElem.value = ''; 
            outputTextElem.placeholder = ''; 
            outputSkeleton.style.display = 'block'; 

            const enhanceMode = document.getElementById('enhanceMode').value;
                let prompt = '';
                switch(enhanceMode) {
                    case 'formal':
                        prompt = `Rephrase the following text to be more formal and professional. Maintain the original meaning and approximate length. Output only the rephrased text, without any introductory phrases or explanations. Original text: "${textToEnhance}"`;
                        break;
                    case 'simplify':
                        prompt = `Directly simplify the following text. Your goal is to make it very easy to understand for anyone. This means you must:
1. Replace any difficult or complex words with much simpler, common alternatives.
2. Break down all long sentences into short, clear, and easy-to-follow sentences.
3. Ensure the core meaning and main idea of the original text are preserved but presented in the simplest possible way.
Important: Your entire output should ONLY be the simplified text itself. Do not include any introductory phrases (like "Here's a simplified version:"), headings (like "Main idea:" or "Instructions:"), explanations of your process, or any other text before or after the simplified content. Original text: "${textToEnhance}"`;
                        break;
                    case 'creative':
                        prompt = `Rewrite this text using more vivid, imaginative, and engaging language. Employ literary devices like metaphors or similes where appropriate, but ensure the core meaning is preserved. Output only the creatively enhanced text, without any introductory phrases. Original text: "${textToEnhance}"`;
                        break;
                    case 'concise':
                        prompt = `Make the following text more concise by removing redundant words and phrases, and restructuring sentences for brevity, while retaining all key information and the original meaning. Output only the condensed text, without any introductory phrases. Original text: "${textToEnhance}"`;
                        break;
                    default:
                        prompt = `Rephrase the following text to be more formal and professional. Maintain the original meaning and approximate length. Output only the rephrased text, without any introductory phrases or explanations. Original text: "${textToEnhance}"`;
                }

            const requestBody = {
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: 1024,
                }
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ error: { message: "Unknown API error or non-JSON response." } }));
                    console.error('API Error Data:', errorData);
                    let detail = "Please check console for details.";
                    if (errorData && errorData.error && errorData.error.message) {
                        detail = errorData.error.message;
                         if (detail.includes("API key not valid")) {
                            detail = "The provided API key is not valid. Please check the key and try again. (This is a placeholder key from the prompt, actual calls will fail).";
                        } else if (response.status === 404 && detail.includes(`models/${MODEL_NAME}`)) {
                            detail = `The model '${MODEL_NAME}' was not found. This might be an issue with the model name or availability. (API call failed due to invalid model).`;
                        } else if (response.status === 400 && detail.toLowerCase().includes("billing")){
                            detail = "API request failed due to a billing issue. Please check your Google Cloud project's billing status.";
                        } else if (response.status === 400 && detail.toLowerCase().includes("field generationconfig.safety")){
                             detail = "API request failed: Invalid safety settings configuration. Please check the safetySettings format or remove them to use defaults.";
                        }
                    }
                    throw new Error(`API request failed with status ${response.status}. ${detail}`);
                }

                const data = await response.json();
                
                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
                    const enhancedText = data.candidates[0].content.parts[0].text;
                    outputTextElem.value = enhancedText.trim();
                } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                    let reason = data.promptFeedback.blockReason;
                    let safetyRatingsInfo = "";
                    if (data.promptFeedback.safetyRatings && data.promptFeedback.safetyRatings.length > 0) {
                       safetyRatingsInfo = data.promptFeedback.safetyRatings.map(r => `${r.category.replace('HARM_CATEGORY_', '')}: ${r.probability}`).join(', ');
                    }
                    const blockMessage = `Content generation blocked. Reason: ${reason}. ${safetyRatingsInfo ? 'Details: ' + safetyRatingsInfo : ''}`;
                    showError(blockMessage);
                    showToast(blockMessage, 'error', 5000);
                    outputTextElem.value = '';
                } 
                else {
                    console.error('Unexpected API response structure:', data);
                    const unexpectedMessage = "Received an unexpected response from the AI. The enhanced text could not be extracted.";
                    showError(unexpectedMessage);
                    showToast(unexpectedMessage, 'error');
                    outputTextElem.value = '';
                }

            } catch (error) {
                console.error('Fetch Error:', error);
                const fetchErrMessage = error.message || "An unexpected error occurred. Please try again.";
                showError(fetchErrMessage);
                showToast(fetchErrMessage, 'error', 5000);
                outputTextElem.value = '';
            } finally {
                enhanceButton.disabled = false;
                buttonIcon.classList.remove('fa-spinner', 'fa-spin');
                buttonIcon.classList.add('fa-wand-magic-sparkles');
                outputSkeleton.style.display = 'none';
                outputTextElem.placeholder = 'Enhanced Text will appear here';
            }
        });

        copyButton.addEventListener('click', () => {
            if (!outputTextElem.value) {
                showToast("Nothing to copy!", "info");
                return;
            }
            navigator.clipboard.writeText(outputTextElem.value)
                .then(() => {
                    showToast("Copied to clipboard!", "success");
                })
                .catch(err => {
                    console.error('Failed to copy: ', err);
                    showToast("Copy failed! Check console.", "error");
                });
        });
        
        clearButton.addEventListener('click', () => {
            inputTextElem.value = '';
            outputTextElem.value = '';
            errorMessageContainer.classList.add('hidden'); 
            showToast("Input cleared!", "success");
        });
        
        pasteButton.addEventListener('click', async () => {
            try {
                const text = await navigator.clipboard.readText();
                if (text) {
                    inputTextElem.value = text;
                    showToast("Pasted from clipboard!", "success");
                } else {
                    showToast("Clipboard is empty or paste permission denied.", "info");
                }
            } catch (err) {
                console.error('Failed to paste: ', err);
                showToast("Paste failed! Check console/permissions.", "error");
            }
        });

        function showError(message) {
            errorMessageElem.textContent = message;
            errorMessageContainer.classList.remove('hidden');
        }

        function showToast(message, type = 'info', duration = 3000) {
            const toastContainer = document.getElementById('toast-container');
            const toastId = 'toast-' + Date.now();
            
            let bgColor, iconHtml, textColor = 'text-white';
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-600/90 backdrop-blur-md border-green-500';
                    iconHtml = '<i class="fas fa-check-circle mr-3"></i>';
                    break;
                case 'error':
                    bgColor = 'bg-red-600/90 backdrop-blur-md border-red-500';
                    iconHtml = '<i class="fas fa-times-circle mr-3"></i>';
                    break;
                case 'info':
                default:
                    bgColor = 'bg-sky-600/90 backdrop-blur-md border-sky-500';
                    iconHtml = '<i class="fas fa-info-circle mr-3"></i>';
                    break;
            }

            const toastElement = document.createElement('div');
            toastElement.id = toastId;
            toastElement.className = `flex items-center w-full max-w-xs p-4 rounded-lg shadow-2xl ${textColor} ${bgColor} border transform toast-enter`;
            toastElement.innerHTML = `${iconHtml}<span class="text-sm font-medium">${message}</span>`;
            
            toastContainer.appendChild(toastElement);

            requestAnimationFrame(() => {
                 toastElement.classList.add('toast-enter-active');
            });

            setTimeout(() => {
                toastElement.classList.remove('toast-enter-active');
                toastElement.classList.add('toast-exit');
                requestAnimationFrame(() => {
                     toastElement.classList.add('toast-exit-active');
                });
                setTimeout(() => {
                    toastElement.remove();
                }, 300); 
            }, duration);
        }
    </script>

</body>
</html>
